# AstraTraffic é¡¹ç›®ç›®å½•ç»“æ„

åŸºäº LangChain æ¶æ„çš„æ™ºæ…§äº¤é€š RAG ç³»ç»Ÿ

---

## ğŸ“ æ ¹ç›®å½•æ–‡ä»¶

```
â”œâ”€â”€ requirements.txt          # Python ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ project_structure.md      # æœ¬æ–‡ä»¶ï¼šé¡¹ç›®ç»“æ„è¯´æ˜
```

---

## ğŸ¯ core/ - æ ¸å¿ƒç¼–æ’

æ ¸å¿ƒ RAG æµç¨‹ç¼–æ’ï¼Œä½¿ç”¨ LangChain LCEL æ„å»º

```
core/
â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â””â”€â”€ rag_chain.py             # RAG æ ¸å¿ƒé“¾ç¼–æ’
                            # - create_rag_chain(): å•è½®é—®ç­”é“¾
                            # - create_rag_chain_with_history(): å¤šè½®å¯¹è¯é“¾
                            # - rag_answer_langchain(): å•è½®é—®ç­”æ¥å£
                            # - rag_answer_with_history(): å¤šè½®å¯¹è¯æ¥å£
```

---

## ğŸ”Œ adapters/ - LangChain é€‚é…å™¨

å°†åº•å±‚å®ç°é€‚é…ä¸º LangChain æ¥å£

```
adapters/
â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ retriever.py            # æ£€ç´¢é€‚é…å™¨
â”‚                           # - CustomRetriever: åŸºç¡€æ£€ç´¢é€‚é…å™¨
â”‚                           # - ToolAwareRetriever: å·¥å…·æ„ŸçŸ¥æ£€ç´¢é€‚é…å™¨
â”‚
â”œâ”€â”€ llm.py                  # LLM é€‚é…å™¨
â”‚                           # - CustomLLM: è‡ªå®šä¹‰ LLM åŒ…è£…å™¨
â”‚                           # - get_langchain_llm(): è·å– LangChain LLM å®ä¾‹
â”‚                           # - get_llm_client(): è·å–åº•å±‚ LLM å®¢æˆ·ç«¯
â”‚
â”œâ”€â”€ prompt.py               # Prompt é€‚é…å™¨
â”‚                           # - create_rag_prompt(): åˆ›å»º RAG Prompt
â”‚                           # - create_rag_prompt_with_history(): åˆ›å»ºå¸¦å†å²çš„ RAG Prompt
â”‚                           # - format_context(): æ ¼å¼åŒ–ä¸Šä¸‹æ–‡
â”‚
â””â”€â”€ query_rewriter.py        # æŸ¥è¯¢æ”¹å†™é€‚é…å™¨
                            # - rewrite_query_with_history(): åŸºäºå†å²æ”¹å†™æŸ¥è¯¢
```

---

## ğŸ”§ services/ - ä¸šåŠ¡é€»è¾‘

å®ç° Agent æ¶æ„çš„ä¸šåŠ¡é€»è¾‘ï¼ˆä¸ä¾èµ– LangChain æ¡†æ¶ï¼‰

```
services/
â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â”‚
â”œâ”€â”€ tool_selector.py        # å·¥å…·é€‰æ‹©ä¸šåŠ¡é€»è¾‘
â”‚                           # - ToolSelector: å·¥å…·é€‰æ‹©å™¨ç±»
â”‚                           # - select_tool(): åŸºäº LLM é€‰æ‹©å·¥å…·
â”‚
â”œâ”€â”€ quality.py              # è´¨é‡æ£€æŸ¥ä¸šåŠ¡é€»è¾‘
â”‚                           # - check_hits_quality(): åˆ¤æ–­æ£€ç´¢ç»“æœè´¨é‡
â”‚
â”œâ”€â”€ fallback.py             # å›é€€ä¸šåŠ¡é€»è¾‘
â”‚                           # - get_no_document_response(): æ— æ–‡æ¡£æ—¶çš„å‹å¥½ç­”å¤
â”‚                           # - should_fallback(): åˆ¤æ–­æ˜¯å¦å›é€€
â”‚                           # - check_has_realtime_info(): æ£€æŸ¥æ˜¯å¦æœ‰å®æ—¶ä¿¡æ¯
â”‚
â”œâ”€â”€ realtime_tool.py        # å®æ—¶å·¥å…·æ‰§è¡Œä¸šåŠ¡é€»è¾‘
â”‚                           # - RealtimeToolExecutor: å®æ—¶å·¥å…·æ‰§è¡Œå™¨
â”‚                           # - execute_realtime_tool(): æ‰§è¡Œå®æ—¶å·¥å…·
â”‚
â”œâ”€â”€ realtime_handler.py     # å®æ—¶æ•°æ®å¤„ç†ä¸šåŠ¡é€»è¾‘
â”‚                           # - get_traffic_client(): è·å–å®æ—¶è·¯å†µå®¢æˆ·ç«¯
â”‚                           # - get_road_traffic(): æŸ¥è¯¢é“è·¯å®æ—¶è·¯å†µ
â”‚                           # - format_traffic_info(): æ ¼å¼åŒ–è·¯å†µä¿¡æ¯
â”‚                           # - extract_road_name_from_query(): ä»æŸ¥è¯¢ä¸­æå–é“è·¯åç§°
â”‚
â””â”€â”€ input_handler.py        # è¾“å…¥å¤„ç†ä¸šåŠ¡é€»è¾‘
                            # - get_history_manager(): è·å–å†å²ç®¡ç†å™¨
```

---

## ğŸ—ï¸ modules/ - åº•å±‚å®ç°

æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œä¸ä¾èµ–ç‰¹å®šæ¡†æ¶ï¼Œå¯ç‹¬ç«‹ä½¿ç”¨

### modules/config/ - é…ç½®ç®¡ç†

```
modules/config/
â”œâ”€â”€ __init__.py             # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ settings.py             # å…¨å±€é…ç½®ä¸­å¿ƒ
â”‚                           # - LLM æ¨¡å‹é…ç½®ï¼ˆOpenAIã€Ollamaã€è‡ªå®šä¹‰ HTTPï¼‰
â”‚                           # - API å¯†é’¥é…ç½®
â”‚                           # - æ£€ç´¢å‚æ•°é…ç½®ï¼ˆFAISSã€BM25ã€é‡æ’åºï¼‰
â”‚                           # - å®æ—¶è·¯å†µAPIé…ç½®
â”‚
â””â”€â”€ tool_config.py          # å·¥å…·é…ç½®ç®¡ç†
                            # - ToolID: å·¥å…·IDç±»å‹å®šä¹‰ï¼ˆLiteralç±»å‹ï¼‰
                            # - ToolConfig: å·¥å…·é…ç½®æ•°æ®ç±»
                            # - _TOOL_CONFIGS: æ‰€æœ‰å·¥å…·é…ç½®
                            # - get_tool_config(): è·å–å·¥å…·é…ç½®
                            # - tool_to_kb_name(): å·¥å…·IDåˆ°çŸ¥è¯†åº“åç§°æ˜ å°„
                            # - tool_to_intent_label(): å·¥å…·IDåˆ°æ„å›¾æ ‡ç­¾æ˜ å°„
```

### modules/rag_types/ - ç±»å‹å®šä¹‰

```
modules/rag_types/
â”œâ”€â”€ __init__.py             # åŒ…åˆå§‹åŒ–
â””â”€â”€ rag_types.py             # é€šç”¨æ•°æ®ç±»å‹å®šä¹‰
                            # - IntentTop, IntentResult: æ„å›¾è¯†åˆ«ç»“æœ
                            # - Hit: æ£€ç´¢ç»“æœ
                            # - Metrics: æ£€ç´¢æŒ‡æ ‡
                            # - AnswerPack: ç­”æ¡ˆåŒ…è£…
                            # - ToolSelection: å·¥å…·é€‰æ‹©ç»“æœ
                            # - RealtimeToolResult: å®æ—¶å·¥å…·æ‰§è¡Œç»“æœ
```

### modules/generator/ - ç”Ÿæˆå™¨æ¨¡å—

```
modules/generator/
â”œâ”€â”€ prompt.py               # Prompt æ¨¡æ¿ï¼ˆåº•å±‚å®ç°ï¼Œä¸ä¾èµ– LangChainï¼‰
â”‚                           # - RAG_PROMPT_TEMPLATE: RAG æç¤ºè¯æ¨¡æ¿
â”‚                           # - RAG_PROMPT_WITH_HISTORY_TEMPLATE: å¸¦å†å²çš„ RAG æç¤ºè¯æ¨¡æ¿
â”‚                           # - TOOL_SELECTION_PROMPT_TEMPLATE: å·¥å…·é€‰æ‹©æç¤ºè¯æ¨¡æ¿
â”‚                           # - ROAD_NAME_EXTRACTION_PROMPT_TEMPLATE: é“è·¯åç§°æå–æç¤ºè¯æ¨¡æ¿
â”‚                           # - format_hits_to_context(): æ ¼å¼åŒ–æ£€ç´¢ç»“æœä¸ºä¸Šä¸‹æ–‡
â”‚                           # - format_chat_history(): æ ¼å¼åŒ–å¯¹è¯å†å²
â”‚                           # - build_tool_selection_prompt(): æ„å»ºå·¥å…·é€‰æ‹©æç¤ºè¯
â”‚                           # - build_road_name_extraction_prompt(): æ„å»ºé“è·¯åç§°æå–æç¤ºè¯
â”‚
â”œâ”€â”€ messages.py             # ç”¨æˆ·æ¶ˆæ¯æ¨¡æ¿ï¼ˆè¾“å‡ºç»™ç”¨æˆ·çš„å†…å®¹ï¼‰
â”‚                           # - get_realtime_traffic_prefix(): å®æ—¶è·¯å†µä¿¡æ¯å‰ç¼€
â”‚                           # - get_no_road_name_message(): æ— æ³•æå–é“è·¯åç§°çš„æç¤º
â”‚                           # - get_traffic_api_failed_message(): APIè°ƒç”¨å¤±è´¥æç¤º
â”‚                           # - get_traffic_success_message(): æŸ¥è¯¢æˆåŠŸæ¶ˆæ¯
â”‚
â””â”€â”€ query_rewriter.py       # æŸ¥è¯¢æ”¹å†™æ¨¡å—ï¼ˆä½¿ç”¨LLMï¼‰
                            # - rewrite_query_with_history(): åŸºäºå¯¹è¯å†å²æ”¹å†™æŸ¥è¯¢
```

### modules/chat/ - å¯¹è¯ç®¡ç†

```
modules/chat/
â”œâ”€â”€ __init__.py             # åŒ…åˆå§‹åŒ–
â””â”€â”€ history.py              # å¯¹è¯å†å²ç®¡ç†æ¨¡å—ï¼ˆå†…å­˜å­˜å‚¨ï¼‰
                            # - ChatHistoryManager: å¯¹è¯å†å²ç®¡ç†å™¨ç±»
                            # - get_history_manager(): è·å–å…¨å±€å†å²ç®¡ç†å™¨å®ä¾‹
                            # - çº¿ç¨‹å®‰å…¨çš„ä¼šè¯ç®¡ç†
```

### modules/retriever/ - æ£€ç´¢æ¨¡å—

```
modules/retriever/
â”œâ”€â”€ rag_retriever.py         # RAG æ£€ç´¢æ ¸å¿ƒå®ç°
â”‚                           # - DenseEncoder: ç¨ å¯†å‘é‡ç¼–ç ï¼ˆSentenceTransformerï¼‰
â”‚                           # - KnowledgeSearcher: æ··åˆæ£€ç´¢ï¼ˆFAISS + BM25 + é‡æ’åºï¼‰
â”‚                           # - KBIngestor: çŸ¥è¯†åº“å…¥åº“å·¥å…·
â”‚
â””â”€â”€ ingest_kb.py            # çŸ¥è¯†åº“å…¥åº“è„šæœ¬ï¼ˆCLI å·¥å…·ï¼‰
                            # ç”¨æ³•: python ingest_kb.py --ingest <çŸ¥è¯†åº“è·¯å¾„> --kb_name <åº“å>
```

### modules/realtime/ - å®æ—¶APIæ¨¡å—

```
modules/realtime/
â”œâ”€â”€ __init__.py             # åŒ…åˆå§‹åŒ–
â””â”€â”€ traffic_api.py          # å®æ—¶è·¯å†µAPIå°è£…
                            # - AmapTrafficAPI: é«˜å¾·åœ°å›¾è·¯å†µAPIå®¢æˆ·ç«¯
                            # - TrafficInfo: è·¯å†µä¿¡æ¯æ•°æ®ç±»
```

### modules/intent/ - æ„å›¾è¯†åˆ«æ¨¡å—ï¼ˆå·²åºŸå¼ƒï¼Œä¿ç•™è®­ç»ƒä»£ç ï¼‰

```
modules/intent/
â”œâ”€â”€ intent_classify.py      # æ„å›¾åˆ†ç±»æ ¸å¿ƒå®ç°ï¼ˆå·²åºŸå¼ƒï¼Œä¿ç•™ç”¨äºè®­ç»ƒï¼‰
â”‚
â””â”€â”€ model_training/         # æ„å›¾æ¨¡å‹è®­ç»ƒç›¸å…³
    â”œâ”€â”€ train/              # è®­ç»ƒè„šæœ¬
    â”‚   â”œâ”€â”€ train_intent_lora.py          # å•ä»»åŠ¡æ„å›¾æ¨¡å‹è®­ç»ƒ
    â”‚   â”œâ”€â”€ train_intent_lora_multitask.py # å¤šä»»åŠ¡æ„å›¾æ¨¡å‹è®­ç»ƒ
    â”‚   â”œâ”€â”€ infer_intent_lora.py          # å•ä»»åŠ¡æ¨ç†è„šæœ¬
    â”‚   â”œâ”€â”€ infer_intent_lora_multitask.py # å¤šä»»åŠ¡æ¨ç†è„šæœ¬
    â”‚   â””â”€â”€ ...
    â”‚
    â”œâ”€â”€ data/               # è®­ç»ƒæ•°æ®å¤„ç†
    â”‚   â”œâ”€â”€ intent/         # æ„å›¾è¯†åˆ«æ•°æ®é›†ï¼ˆtrain/dev/testï¼‰
    â”‚   â”œâ”€â”€ label_data/     # åŸå§‹æ ‡æ³¨æ•°æ®
    â”‚   â””â”€â”€ ...
    â”‚
    â””â”€â”€ models/             # è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆæœ¬åœ°ï¼‰
        â”œâ”€â”€ bert-base-chinese/            # åŸºç¡€ BERT æ¨¡å‹
        â””â”€â”€ bert-intent-lora-v1/          # LoRA å¾®è°ƒåçš„æ„å›¾æ¨¡å‹
```

**æ³¨æ„**ï¼šæ„å›¾è¯†åˆ«åŠŸèƒ½å·²åºŸå¼ƒï¼Œç³»ç»Ÿç°åœ¨ä½¿ç”¨ LLM æç¤ºè¯è¿›è¡Œå·¥å…·é€‰æ‹©ã€‚æ­¤ç›®å½•ä¿ç•™ç”¨äºè®­ç»ƒä»£ç å‚è€ƒã€‚

---

## ğŸ“š data/ - æ•°æ®ç›®å½•

### data/knowledge/ - çŸ¥è¯†åº“åŸå§‹æ–‡ä»¶

```
data/knowledge/
â”œâ”€â”€ ev/           # ç”µåŠ¨æ±½è½¦çŸ¥è¯†åº“
â”œâ”€â”€ handbook/     # æ“ä½œæ‰‹å†ŒçŸ¥è¯†åº“
â”œâ”€â”€ health/       # å¥åº·çŸ¥è¯†åº“
â”œâ”€â”€ iov/          # è½¦è”ç½‘çŸ¥è¯†åº“
â”œâ”€â”€ law/          # æ³•å¾‹æ³•è§„çŸ¥è¯†åº“
â”œâ”€â”€ parking/      # åœè½¦çŸ¥è¯†åº“
â”œâ”€â”€ report/       # æŠ¥å‘ŠçŸ¥è¯†åº“
â””â”€â”€ transit/      # äº¤é€šçŸ¥è¯†åº“
```

### data/models/ - é¢„è®­ç»ƒæ¨¡å‹æ‰“åŒ…

```
data/models/
â”œâ”€â”€ bert-base-chinese/        # ä¸­æ–‡ BERT åŸºç¡€æ¨¡å‹ï¼ˆHuggingFaceï¼‰
â””â”€â”€ ds_single/                # LoRA å¾®è°ƒåçš„æ„å›¾æ¨¡å‹ï¼ˆå·²åºŸå¼ƒï¼Œä¿ç•™ç”¨äºå‚è€ƒï¼‰
```

### data/storage/ - æ£€ç´¢ç´¢å¼•å­˜å‚¨

æ¯ä¸ªçŸ¥è¯†åº“å¯¹åº”ä¸€ä¸ªå­ç›®å½•ï¼ŒåŒ…å«ï¼š

```
data/storage/
â”œâ”€â”€ <kb_name>/                # çŸ¥è¯†åº“åç§°ï¼ˆå¦‚ ev, health, law ç­‰ï¼‰
â”‚   â”œâ”€â”€ index.faiss          # FAISS å‘é‡ç´¢å¼•æ–‡ä»¶
â”‚   â”œâ”€â”€ meta.jsonl           # æ–‡æ¡£å…ƒæ•°æ®ï¼ˆæ–‡æœ¬ã€æ¥æºç­‰ï¼‰
â”‚   â””â”€â”€ bm25_tokens.json     # BM25 åˆ†è¯ç´¢å¼•
```

**æ³¨æ„**ï¼šè¿™äº›ç´¢å¼•æ–‡ä»¶ç”± `modules/retriever/ingest_kb.py` ç”Ÿæˆ

---

## ğŸš€ scripts/ - è„šæœ¬ç›®å½•

```
scripts/
â””â”€â”€ cli.py                    # å‘½ä»¤è¡Œäº¤äº’å·¥å…·
                              # ç”¨æ³•: python scripts/cli.py
                              # æä¾›äº¤äº’å¼é—®ç­”ç•Œé¢
```

---

## ğŸ“‹ æ¶æ„è¯´æ˜

### åˆ†å±‚è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  scripts/cli.py                     â”‚  åº”ç”¨å±‚
â”‚  (CLI äº¤äº’)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  core/rag_chain.py                    â”‚  æ ¸å¿ƒç¼–æ’å±‚
â”‚  (RAG æµç¨‹ç¼–æ’)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                     â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ adapters/â”‚    â”‚  services/       â”‚
â”‚ (é€‚é…å±‚)  â”‚    â”‚  (ä¸šåŠ¡é€»è¾‘)      â”‚
â”‚          â”‚    â”‚                  â”‚
â”‚ LangChainâ”‚    â”‚  - å·¥å…·é€‰æ‹©      â”‚
â”‚ æ¥å£é€‚é…  â”‚    â”‚  - è´¨é‡æ£€æŸ¥      â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  - å›é€€é€»è¾‘      â”‚
    â”‚            â”‚  - å®æ—¶å·¥å…·      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  modules/                             â”‚  åº•å±‚å®ç°å±‚
â”‚  - config/    é…ç½®ç®¡ç†                â”‚  - ä¸šåŠ¡é€»è¾‘å®ç°
â”‚  - types/     ç±»å‹å®šä¹‰                â”‚  - ä¸ä¾èµ–ç‰¹å®šæ¡†æ¶
â”‚  - generator/  Prompt & æ¶ˆæ¯æ¨¡æ¿       â”‚  - å¯ç‹¬ç«‹ä½¿ç”¨
â”‚  - chat/      å¯¹è¯å†å²ç®¡ç†            â”‚
â”‚  - retriever/ FAISS + BM25 æ£€ç´¢      â”‚
â”‚  - realtime/  å®æ—¶APIå°è£…             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  data/                               â”‚  æ•°æ®å±‚
â”‚  - knowledge/                        â”‚  - åŸå§‹çŸ¥è¯†åº“
â”‚  - models/                           â”‚  - é¢„è®­ç»ƒæ¨¡å‹
â”‚  - storage/                          â”‚  - æ£€ç´¢ç´¢å¼•
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥ 
  â†“
å·¥å…·é€‰æ‹© (LLM æç¤ºè¯)
  â†“
è·¯ç”±åˆ°çŸ¥è¯†åº“æˆ–å®æ—¶å·¥å…· (æ ¹æ®å·¥å…·é€‰æ‹©)
  â†“
æ£€ç´¢ (FAISS + BM25 + Reranker) æˆ– å®æ—¶APIè°ƒç”¨
  â†“
è´¨é‡æ£€æŸ¥ (ç½®ä¿¡åº¦é˜ˆå€¼)
  â†“
æ ¼å¼åŒ–ä¸Šä¸‹æ–‡
  â†“
LLM ç”Ÿæˆç­”æ¡ˆ
  â†“
åå¤„ç† (æ·»åŠ å¼•ç”¨)
  â†“
è¿”å›ç­”æ¡ˆ
```

---

## ğŸ”‘ å…³é”®é…ç½®æ–‡ä»¶

- **modules/config/settings.py**: å…¨å±€é…ç½®ï¼ˆæ¨¡å‹è·¯å¾„ã€API å¯†é’¥ã€æ£€ç´¢å‚æ•°ï¼‰
- **modules/config/tool_config.py**: å·¥å…·é…ç½®ï¼ˆå·¥å…·IDã€æè¿°ã€çŸ¥è¯†åº“æ˜ å°„ï¼‰
- **requirements.txt**: Python ä¾èµ–åŒ…
- **.env**: ç¯å¢ƒå˜é‡ï¼ˆé€šå¸¸ä¸æäº¤åˆ° Gitï¼Œéœ€è¦å•ç‹¬é…ç½®ï¼‰

---

## ğŸ“ ä½¿ç”¨è¯´æ˜

### 1. åˆå§‹åŒ–ç¯å¢ƒ

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env  # å¦‚æœæœ‰ç¤ºä¾‹æ–‡ä»¶
# ç¼–è¾‘ .env å¡«å…¥ API keys ç­‰é…ç½®
```

### 2. å‡†å¤‡çŸ¥è¯†åº“

```bash
# å…¥åº“çŸ¥è¯†åº“ï¼ˆç¤ºä¾‹ï¼‰
python modules/retriever/ingest_kb.py --ingest data/knowledge/law --kb_name law
python modules/retriever/ingest_kb.py --ingest data/knowledge/parking --kb_name parking
```

### 3. è¿è¡Œåº”ç”¨

```bash
# å‘½ä»¤è¡Œäº¤äº’
python scripts/cli.py
```

---

## ğŸ—‚ï¸ æ–‡ä»¶å‘½åçº¦å®š

- **é€‚é…å™¨**: `adapters/*.py` - LangChain æ¥å£é€‚é…
- **ä¸šåŠ¡é€»è¾‘**: `services/*.py` - ä¸šåŠ¡é€»è¾‘å®ç°
- **æ ¸å¿ƒç¼–æ’**: `core/*.py` - RAG æµç¨‹ç¼–æ’
- **åº•å±‚å®ç°**: `modules/*/*.py` - æ¡†æ¶æ— å…³çš„æ ¸å¿ƒå®ç°
- **é…ç½®**: `modules/config/*.py` - é…ç½®ç®¡ç†
- **ç±»å‹**: `modules/rag_types/*.py` - ç±»å‹å®šä¹‰

---

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **æ¨¡å‹æ–‡ä»¶**: `data/models/` å’Œ `modules/intent/model_training/models/` ä¸­çš„æ¨¡å‹æ–‡ä»¶é€šå¸¸è¾ƒå¤§ï¼Œå»ºè®®ä½¿ç”¨ Git LFS æˆ–å•ç‹¬ä¸‹è½½
2. **ç´¢å¼•æ–‡ä»¶**: `data/storage/` ä¸­çš„ç´¢å¼•æ–‡ä»¶ç”±å…¥åº“è„šæœ¬è‡ªåŠ¨ç”Ÿæˆï¼Œé¦–æ¬¡ä½¿ç”¨éœ€è¦å…ˆè¿è¡Œå…¥åº“
3. **ç¯å¢ƒå˜é‡**: `.env` æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œä¸è¦æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
4. **ä¾èµ–ç‰ˆæœ¬**: å»ºè®®ä¸¥æ ¼æŒ‰ç…§ `requirements.txt` ä¸­çš„ç‰ˆæœ¬å®‰è£…ï¼Œé¿å…å…¼å®¹æ€§é—®é¢˜
5. **å‘åå…¼å®¹**: `lc/` ç›®å½•å·²åºŸå¼ƒï¼Œæ–°ä»£ç åº”ä½¿ç”¨æ–°çš„ç›®å½•ç»“æ„ï¼ˆ`adapters/`ã€`services/`ã€`core/`ï¼‰

---
